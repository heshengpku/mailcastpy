# 邮件群发系统

这是一个基于Python和Tkinter开发的邮件群发系统，支持自定义参数、HTML格式邮件和批量发送功能。

## 功能特点

- 邮件模板功能
  - 支持HTML和纯文本格式邮件
  - 富文本编辑器（加粗、斜体、下划线）
  - 自定义字体和字号
  - 变量替换功能（使用{参数名}格式）

- 参数管理系统
  - 内置基本参数（姓名、邮箱）
  - 自定义参数支持
  - 参数有效性验证
  - 导入CSV时自动匹配参数

- 收件人管理
  - CSV文件导入导出
  - 双击编辑收件人信息
  - 实时显示发送状态
  - 支持清空和重新导入

- 邮件发送功能
  - SMTP服务器配置
  - 发送前参数校验
  - 批量发送支持
  - 发送状态实时更新

## 安装说明

1. 系统要求：
   - Python 3.x
   - Windows/Linux/MacOS

2. 安装依赖：

   ```bash
   pip install -r requirements.txt
   ```

## 使用说明

1. 启动程序：

   ```bash
   python main.py
   ```

2. 配置邮件服务器：
   - 填写SMTP服务器地址和端口
   - 输入发件人邮箱和密码
   - 点击"发送前校验"测试连接

3. 设置自定义参数（可选）：
   - 系统默认支持name和email参数
   - 点击"添加参数"创建新参数
   - 设置参数显示名称和标识符
   - 注意：导入CSV后将锁定参数设置

4. 编辑邮件模板：
   - 编写邮件主题和正文
   - 使用{参数名}插入变量
   - 可以切换HTML/纯文本格式
   - 支持文本格式化（加粗、斜体等）

5. 管理收件人列表：
   - 通过CSV文件导入收件人
   - 双击编辑单个收件人信息
   - 可以随时保存或清空列表
   - 支持导出当前收件人列表

6. 发送邮件：
   - 点击"发送前校验"确认配置
   - 点击"发送邮件"开始发送
   - 可实时查看发送状态
   - 支持批量发送

## CSV文件格式要求

1. 必需列：
   - name 或 Name（收件人姓名）
   - email 或 Email（邮箱地址）

2. 自定义参数列：
   - 列名需要与参数标识符匹配
   - 不区分大小写
   - 支持中文列名
   - 未使用的列会被忽略

## 注意事项

1. 参数设置：
   - 导入CSV后无法修改参数设置
   - 需要修改参数时请先清空收件人列表
   - 参数标识符在模板中需要用{}包围

2. 邮件发送：
   - 发送前请确保所有参数已正确设置
   - 建议先使用测试账号验证模板
   - 注意SMTP服务器的发送限制

3. 数据安全：
   - 密码等敏感信息不会被保存
   - 建议定期备份收件人数据
   - CSV文件请使用UTF-8编码

## 项目结构

```txt
src/
├── gui/                # GUI相关组件
│   ├── components/     # UI组件
│   │   ├── parameter_panel.py    # 参数设置面板
│   │   ├── preview_window.py     # 邮件预览弹窗
│   │   ├── recipients_panel.py   # 收件人列表面板
│   │   ├── server_panel.py       # 服务器设置面板
│   │   └── template_panel.py     # 模板编辑面板
│   └── email_sender_window.py    # 主窗口
├── services/           # 业务逻辑
│   ├── email_service.py          # 邮件发送服务
│   ├── parameter_service.py      # 参数管理服务
│   ├── recipients_service.py     # 收件人管理服务
│   └── template_service.py       # 模板处理服务
└── utils/             # 工具函数
    ├── csv_handler.py            # CSV文件处理
    └── font_manager.py          # 字体管理
```

## 开发说明

1. 代码规范：
   - 遵循PEP 8规范
   - 使用类型注解
   - 包含详细的注释说明

2. 架构设计：
   - 采用MVC架构
   - 服务层处理业务逻辑
   - UI组件负责显示和交互

3. 错误处理：
   - 统一的异常处理机制
   - 友好的错误提示
   - 详细的日志记录
